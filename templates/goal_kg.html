{% extends 'base.html' %}
{% block title %}Zielsetzung KG{% endblock %}
{% block content %}
<div x-data="goalKG()" class="space-y-4">
    <form hx-post="/api/goals/" hx-swap="none" @htmx:afterRequest="updateSmart" class="space-y-2">
        <input type="hidden" name="user_session" value="{{ user_session_id }}">
        <textarea name="raw_text" class="w-full border p-2" placeholder="Was mÃ¶chtest du erreichen?"></textarea>
        <button class="bg-green-500 text-white px-4 py-2 w-full sm:w-auto">Ziel speichern</button>
    </form>
    <div class="flex flex-wrap gap-2 text-xs">
        <template x-for="(val, key) in smart" :key="key">
            <span class="px-2 py-1 rounded" :class="val ? 'bg-green-200' : 'bg-gray-200'" x-text="key"></span>
        </template>
    </div>
</div>
<script>
function goalKG(){
    return {
        smart:{specific:false, measurable:false, achievable:false, relevant:false, time_bound:false},
        updateSmart(e){
            let data={};
            try{ data = JSON.parse(e.detail.xhr.responseText);}catch(err){}
            if(data.smart_score){ this.smart = data.smart_score; }
        }
    }
}
</script>
{% endblock %}
